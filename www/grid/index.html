<html>
<head>
	<title></title>
<script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
<script src="/grid/control.js" crossorigin="anonymous"></script>
</head>
<body>
<h1>Testing page</h1>

<div>
<h2>Auth</h2>
 
<div id="login" class="hidden">Login</div>
<div id="logout" class="hidden">Logout</div>
<div id="secured" class="hidden">Secured</div>
<a href="" id="secured-content">Secured page</a>
<div id="content"></div>

<script type="text/javascript">
$('.hidden').hide();
totiAuth.onLoad();
console.log(totiAuth.getToken());

if (totiAuth.getToken()) {
	$('#logout').show();
	$('#secured').show();
} else {
	$('#login').show();
}
$('#login').click(function() {
	totiAuth.login({"username": "user1"}, {
		"loginUrl": "/sign/login",
		"loginMethod": "POST",
		"refreshUrl": "/sign/refresh",
		"refreshMethod": "POST",
		"logoutUrl": "/sign/logout",
		"logoutMethod": "POST"
	});
});
$('#logout').click(function() {
	totiAuth.logout();
});
$('#secured-content').click(function(e) {
	e.preventDefault();
	console.log(totiAuth.getAuthHeader());
	$.ajax({
		url: "/base/first",
		headers: totiAuth.getAuthHeader(),
		success: function (data) {
			$('#content').html(data);
		},
		failure: function(xhr, a, b) {
			console.log(xhr, a, b);
		}
	});
});

</script>

</div>

<div>

<a href="readme.md" class="link">ReadMe</a>
<a href="test.html" class="link">Test</a>
<a href="/test.ods" class="link">Ods</a>
 <script type="text/javascript">
 	$('.link').click(function(e) {
 		e.preventDefault();
 		totiControl.load.link($(this).attr('href'), "get", {}, totiAuth.getAuthHeader());
 	});
 </script>
</div>

<div>
		<h2>Form</h2>
		<div id="form"></div>
		<script>
			var formname = "formName";
			var formConfig = {
				"formId": "frm-Test",
				"action": "/base/second",
				"method": "post",
				"fields": [
					{
						"name": "a",
						"id": "some-id",
						"type": "number"
					},
					{
						"name": "b",
						"id": "some-text-id",
						"type": "text",
						"title": "Name",
						"required": "required"
					},
					{
						"name": "c",
						"id": "some-select-id",
						"type": "select",
						"title": "select text",
						"required": "required",
						"options": [
							{
								"value": "a",
								"title": "A"
							},
							{
								"value": "b",
								"title": "B"
							}
						]
					},
					{
						"name": "d",
						"id": "hidden-id",
						"type": "hidden"
					},
					{
						"type": "submit",
						'value': "Submit",
						"confirmation": function(param) {
							console.log(param);
							return true;
						},
						"onSuccess": function(data) {
							console.log(data);
						}
					}
				],
				"bind": {
					"url": "/base/item",
					"method": "get",
					"params": {},
					"onFailure": function(){}
				},
				"headers": {
					"Accept-Language": "de-DE",
					"Header": "header"
				}
			};
			totiForm.init('div#form', formname, formConfig);

		</script>
	</div>


		<h2>Grid</h2>
		<div id="grid"></div>
		<script>
			var name = "gridName";
			var gridConfig = {
				"dataLoadUrl": "/base/grid/items",
				"dataLoadMethod": "get",
				"identifier": "id",
				"columns": [
						{
							"name": "actions",
							"type": "actions",
							"title": "Actions",
							"useSorting": false
						},
						{
							"name": "id",
							"sorting": false,
							"type": "value"
						},
						{
							"name": "name",
							"type": "value",
							"filter": {
								"type": "text"
							},
							"title": "Name",
							"useSorting": true
						},
						{
							"name": "maried",
							"type": "value",
							"filter": {
								"type": "select",
								"options": [
									{
										"value": 1,
										"title": "ANO"
									},
									{
										"value": 2,
										"title": "NE"
									}
								]
							},
							"title": "Maried",
							"useSorting": true,
							"renderer": function(value) {
								if (value === 'false') {
									return "NO";
								} else if (value === 'true') {
									return "YES";
								}
							}
						},
						{
							"name": "age",
							"title": "Age",
							"filter": {
								"type": "number",
								"step": 2
							},
							"useSorting": true,
							"type": "value"
						},
						{
							"name": "datetime",
							"title": "Datetime",
							"filter": {
								"type": "datetime"
							},
							"useSorting": true,
							"type": "value"
						},
						{
							"name": "button",
							"type": "buttons",
							"buttons": [
								{
									"confirmation": function(row) {
										return confirm("realy");
									},
									"title": "Delete",
									"href": function(row) {

									},
									"ajax": true,
									"class": "",
									"onSuccess": function() {},
									"onFailure": function() {}
								},
								{
									"title": "Link",
									"href": function(row) {
										return "link";
									},
									"ajax": false,
									"class": "",
									"onSuccess": function() {},
									"onFailure": function() {}
								}
							],
							"title": "Buttons",
							"useSorting": false
						}
					],
				"pages": {
					"pagesSizes": [5,10,15,20],
					"defaultSize": 10,
					"pagesButtonCount": 5
				},
				"actions": {
					"actionsList": [
						{
							"link": "link1",
						 	"title": "action 1",
						 	"ajax": true,
						 	"method": "POST"
						 },
						{
							"link": "link2",
						 	"title": "action 2",
						 	"ajax": true,
						 	"method": "POST"
						 }
					],
					"onSuccess": function(param1) {
						console.log("action success ", param1);
					},
					"onError": function(param1, param2, param3) {
						console.log("Action failure", param1, param2, param3);
					}
				}/*,
				"headers": {
					"Accept-Language": "de-DE",
					"Header": "header"
				}*/
			};
			totiGrid.init('div#grid', name, gridConfig);

		</script>
	</div>	
	
	<div>
		<h2>Inputs alone</h2>
		<button class="show" id="inputs-alone">Show</button>
		<button class="hide" id="inputs-alone">Hide</button>
		<div id="inputs-alone"></div>
		<script>
			$('div#inputs-alone')
				.append(totiControl.inputs.label("radio1a", "Radio 1 A"))
				.append(totiControl.inputs.radio({"name": "radio", "value": 1, "id": "radio1a"}))
				.append(totiControl.inputs.label("radio1b", "Radio 1 B"))
				.append(totiControl.inputs.radio({"name": "radio", "value": 2, "id": "radio1b"}))
				.append('<br>')
				.append(totiControl.inputs.label("radio2", "Radio2"))
				.append(totiControl.inputs.radio({"name": "radio2", "value": 1, "id": "radio2"}))
				.append('<br>')
				.append(totiControl.inputs.label("checkbox", "Checkbox"))
				.append(totiControl.inputs.checkbox({"id": "checkbox"}))
				.append('<br>')
				.append(totiControl.inputs.label("number", "Number"))
				.append(totiControl.inputs.number({"id": "number"}))
				.append('<br>')
				.append(totiControl.inputs.label("text", "Text"))
				.append(totiControl.inputs.text({"id": "text"}))
				.append('<br>')
				.append(totiControl.inputs.label("password", "Password"))
				.append(totiControl.inputs.password({"id": "password"}))
				.append('<br>')
				.append(totiControl.inputs.label("email", "Email"))
				.append(totiControl.inputs.email({"id": "email"}))
				.append('<br>')
				.append(totiControl.inputs.label("datetime", "Datetime"))
				.append(totiControl.inputs.datetime({"id": "datetime"}))
				.append('<br>')
				.append(totiControl.inputs.label("select", "Select"))
				.append(totiControl.inputs.select(
					[
						totiControl.inputs.option(1, "Option 1"),
						totiControl.inputs.option(2, "Option 2")
					],
					{"id": "select"}
				))
				.append('<br>')
				.append(totiControl.inputs.submit(false, null, {}))
				.append('<br>')
				.append(totiControl.inputs.button(false, null, "button", "", {}))
				.append('<br>');

		</script>
	</div>

<hr>

	<div>
		<h2>Inputs in form</h2>
		<button class="show" id="inputs-form">Show</button>
		<button class="hide" id="inputs-form">Hide</button>
		<div id="inputs-form"><form id="simple-form"></form></div>
		<script>
			$('#simple-form')
				.append(totiControl.inputs.label("form-radio1a", "Radio 1 A"))
				.append(totiControl.inputs.radio({"name": "radio", "value": 1, "id": "form-radio1a"}))
				.append(totiControl.inputs.label("form-radio1b", "Radio 1 B"))
				.append(totiControl.inputs.radio({"name": "radio", "value": 2, "id": "form-radio1b"}))
				.append('<br>')
				.append(totiControl.inputs.label("form-radio2", "Radio2"))
				.append(totiControl.inputs.radio({"name": "radio2", "value": 1, "id": "form-radio2"}))
				.append('<br>')
				.append(totiControl.inputs.label("form-checkbox", "Checkbox"))
				.append(totiControl.inputs.checkbox({"id": "form-checkbox"}))
				.append('<br>')
				.append(totiControl.inputs.label("form-number", "Number"))
				.append(totiControl.inputs.number({"id": "form-number"}))
				.append('<br>')
				.append(totiControl.inputs.label("form-text", "Text"))
				.append(totiControl.inputs.text({"id": "form-text"}))
				.append('<br>')
				.append(totiControl.inputs.label("form-password", "Password"))
				.append(totiControl.inputs.password({"id": "form-password"}))
				.append('<br>')
				.append(totiControl.inputs.label("form-email", "Email"))
				.append(totiControl.inputs.email({"id": "form-email"}))
				.append('<br>')
				.append(totiControl.inputs.label("form-datetime", "Datetime"))
				.append(totiControl.inputs.datetime({"id": "form-datetime"}))
				.append('<br>')
				.append(totiControl.inputs.label("form-select", "Select"))
				.append(totiControl.inputs.select(
					[
						totiControl.inputs.option(1, "Option 1"),
						totiControl.inputs.option(2, "Option 2")
					],
					{"id": "form-select"}
				))
				.append('<br>')
				.append(totiControl.inputs.submit(false, null, {}))
				.append('<br>')
				.append(totiControl.inputs.button(false, null, "button", "", {}))
				.append('<br>');

		</script>
	</div>
<hr>

<div>
	<h2>Submiting</h2>
	<button class="show" id="submiting">Show</button>
	<button class="hide" id="submiting">Hide</button>
	<div id="submiting">
		<form id="submit-types" action="" method="POST">
			<input type="text" name="text">
		</form>
		<div id="submit-link"></div>
	</div>

<script type="text/javascript">
	$('#submit-types')
		.append(
			totiControl.inputs.submit(
				false, 
				function(){
					console.log("Normal submit confirmation");
					return confirm("Confirm");
				}, 
				{"value": "Default submit", "form": "submit-types"}
			)
		)
		.append(
			totiControl.inputs.submit(
				function(data, url, method) {
					console.log("Async submit sending");
					console.log(data, url, method);
				}, 
				function(){
					console.log("Async submit confirmation");
					return confirm("Confirm");
				},
				{"value": "Async submit", "form": "submit-types"}
			)
		)
		/***********/
		.append(
			totiControl.inputs.button(
				false,
				function () {
					console.log("Link button confirmation");
					return confirm("Confirm");
				},
				"Link Button",
				"", 
				{"form": "submit-types"}
			)
		)
		.append(
			totiControl.inputs.button(
				function(data) {
					console.log("Async button sending");
					console.log(data);
				}, 
				function () {
					console.log("Async button confirmation");
					return confirm("Confirm");
				},
				"Async Button",
				"", 
				{"form": "submit-types"}
			)
		);
		/******************/
		$('#submit-link')
			.append(
				totiControl.inputs.button(
					false,
					function () {
						console.log("Link button confirmation");
						return confirm("Confirm");
					},
					"Link Button",
					"", 
					{}
				)
			)
			.append(
				totiControl.inputs.button(
					function(data) {
						console.log("Async button sending");
						console.log(data);
					}, 
					function () {
						console.log("Async button confirmation");
						return confirm("Confirm");
					},
					"Async Button",
					"", 
					{}
				)
			);
</script>

</div>

<div>
	<h2>Pagging</h2>
	<button class="show" id="pagging">Show</button>
	<button class="hide" id="pagging">Hide</button>
	<div id="pagging"></div>

	<script type="text/javascript">
	/*	var pages = $('div#pagging');
		pages.append(totiGrid.pages.print('name', 5));
		totiGrid.pages.onLoad('name', 5, 10);
		pages.append('<br>');
		pages.append("Actual page " + totiGrid.pages.get('name'));
		pages.append('<br>');
		pages.append(totiGrid.pagesSize.print('name', [5,10,15,20,25], 10));
		pages.append('<br>');
		pages.append("Selected size " + totiGrid.pagesSize.get('name'));*/
	</script>

</div>

<div>
	<h2>Sorting</h2>
	<button class="show" id="sorting">Show</button>
	<button class="hide" id="sorting">Hide</button>
	<div id="sorting"></div>

	<script type="text/javascript">
		var pages = $('div#sorting');
		var columns = [
			{
				"name": "column1",
				"useSorting": false,
				"title": null
			},
			{
				"name": "column2",
				"useSorting": true,
				"title": null
			},
			{
				"name": "column3",
				"useSorting": false,
				"title": "Column 3"
			},
			{
				"name": "column4",
				"useSorting": true,
				"title": "Column 4"
			},
		];
		pages.append(totiGrid.sorting.print('name', columns));
		// totiGrid.sorting.print('name')
		pages.append('<br>');
		pages.append(totiGrid.sorting.get('name'));
	</script>

</div>

<br><br><br><br><br><br>
<script type="text/javascript">
	$('.hide').click(function(argument) {
		$('.show#' + $(this).attr('id')).show();
		$('div#' + $(this).attr('id')).hide();
		$(this).hide();
		// $(this).next('div').hide();
	});
	$('.show').click(function(argument) {
		$('.hide#' + $(this).attr('id')).show();
		$('div#' + $(this).attr('id')).show();
		$(this).hide();
		// $(this).next('div').show();
	});
	$('.hide').hide();
	$('.hide').next('div').hide();
</script>


</body>
</html>