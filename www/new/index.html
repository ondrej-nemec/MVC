<html>
<head>
	<title></title>

	<script src="images.js" ></script>
	<script src="utils.js" ></script>
	<script src="settings.js"></script>
	<script src="storage.js" ></script>
	<script src="lang.js" ></script>
	<script src="load.js" ></script>
	<script src="auth.js" ></script>
	<script src="display.js" ></script>

	<script src="control.js" ></script>
	<script src="grid.js"></script>
	<script src="form.js" ></script>
</head>
<body>
	<div id="flash"></div>


	<script type="text/javascript">
		totiDisplay.flash("info", "success");
		totiDisplay.storedFlash("info", "success2");
	</script>

	<p id="login"></p>
	<input type="button" value="Přihlásit" id="in" /><br>
	<input type="button" value="Ohlásit" id="out" /><br>
	
	<script>
		totiAuth.onLoad();
		if (totiAuth.getToken() !== null) {
			document.getElementById('login').innerHTML = "Logged";
		}
		document.getElementById('in').onclick = function() {
			totiLoad.async("/entity/api/sign/in", "post", {
				username: "user-name"
			},
			{},
			function(response) {
				totiAuth.login(response, {
					logout: {
						url: "/entity/api/sign/out",
						method: "post"
					},
					refresh: {
						url: "/entity/api/sign/refresh",
						method: "post"
					}
				});
				location.reload();
			}, function (xhr) {
				totiControl.display.flash("error", "<t:trans message='auth.login.cannot-login-user' />");
			});
		};
		document.getElementById('out').onclick =function() {
			totiAuth.logout();
			location.reload();
		};
	</script>
	
	<a href="" id="link">Next page</a>

	<script type="text/javascript">
		
		document.getElementById("link").onclick = function(e) {
			e.preventDefault();
			totiLoad.link("/entity/entity/action3", "post", {}, totiAuth.getAuthHeader());
		};
a();
		function a() {
			totiLoad.async("/entity/entity/action3", "post", {
				"aaa": "bbb"
			},
			totiAuth.getAuthHeader(),
			function(xhr) {
				console.log("success");
			}, function(xhr) {
				console.log("error");
			});
			totiLoad.async("/entity/entity/action2", "post", {}, totiAuth.getAuthHeader(), function(xhr) {
				console.log("success");
			}, function(xhr) {
				console.log("error");
			});
			totiLoad.async("/entity/entity/action1", "post", {}, totiAuth.getAuthHeader(), function(xhr) {
				console.log("success");
			}, function(xhr) {
				console.log("error");
			});
		}
	</script>

</body>
</html>